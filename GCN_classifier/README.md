## PyTorch Geometric
*PyTorch Geometric* (PyG) is a geometric deep learning extension library for [PyTorch](https://pytorch.org/).

It consists of various methods for deep learning on graphs and other irregular structures, also known as *[geometric deep learning](http://geometricdeeplearning.com/)*, from a variety of published papers.
In addition, it consists of an easy-to-use mini-batch loader for many small and single giant graphs, multi gpu-support, a large number of common benchmark datasets (based on simple interfaces to create your own), and helpful transforms, both for learning on arbitrary graphs as well as on 3D meshes or point clouds.



## Code Environment

1. Ensure that PyTorch 1.4.0 is installed (version 1.4.0 for us):

   ```python
   $ python -c "import torch; print(torch.__version__)"
   >>> 1.4.0
   ```
2. Find the CUDA version PyTorch was installed with (version 10.1 for us):
   ```python
   $ python -c "import torch; print(torch.version.cuda)"
   >>> 10.1
   ```
3. Install the four relevant packages(https://pytorch-geometric.com/whl/torch-1.4.0+cu101.html):
   ```
   torch-cluster         1.5.4
   torch-scatter         2.0.4
   torch-sparse          0.6.1
   torch-spline-conv     1.2.0
   ```
4. Install torch-geometric (version 1.6.0 for us)
   ```pip install torch-geometric==1.6.0```

The entire configuration process can refer to the website: https://pytorch-geometric.readthedocs.io/en/latest/notes/installation.html 


## GCN classifier
Our code is directly modified based on the template in the *PyG package*.
The dataset generated by the feature generation process of STMMQR are stored in *./GCN_classifier/data/Classorder/raw*, which contains 408 sparse matrices.

Training set and validation set divided by the program is stored in *./GCN_classifier/data/Classorder/processed*.

The eight datasets shown in paper Fig.12 are stored in ./GCN_classifier/data/Classtest/raw.

You can run `python graphclass.py` to train the model and verify the inference results of the GCN classifier.

Then run `python testgraph.py` to predict the classifications of eight datasets. In order to verify its effect, we recorded the predicted results and substituted them back into *STMMQR* to select the corresponding reordering method for testing.

